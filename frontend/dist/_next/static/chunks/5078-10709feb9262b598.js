"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5078],{2853:(e,s,n)=>{n.d(s,{Hq:()=>x,Qp:()=>m,Td:()=>a,Y4:()=>h,gD:()=>d,ux:()=>v,v2:()=>c,yi:()=>u});var l=n(4723);let t=e=>{try{return(0,l.Yq)(e,{includeYear:!0,format:"long"})}catch(e){return"날짜 없음"}},i=e=>{try{return(0,l.fU)(e)}catch(s){return e}},o=e=>{switch(e){case"ACTIVE":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"COMPLETED":return"bg-blue-100 text-blue-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};function a(e){return{id:e.id,date:e.date,startTime:e.startTime,endTime:e.endTime,classId:e.classId,class:{id:e.classId,className:"클래스",level:"BEGINNER",tuitionFee:"0",teacher:{id:0,name:"선생님"}},currentStudents:e.currentStudents,maxStudents:e.maxStudents,isEnrollable:!0,isFull:e.currentStudents>=e.maxStudents,isPastStartTime:new Date(e.date+"T"+e.startTime)<new Date,isAlreadyEnrolled:!1,studentEnrollmentStatus:null,enrollments:(e.enrollments||[]).map(s=>({id:s.id,sessionId:e.id,studentId:s.studentId,status:s.status,enrolledAt:s.enrolledAt}))}}function r(e){return{...e,displayJoinedAt:t(new Date().toISOString()),displayLevel:"레벨 정보 없음",statusColor:o("ACTIVE"),canManage:!0}}function u(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{students:e.map(r),totalCount:e.length,activeCount:e.length,isLoading:s,error:n}}function d(e){var s,n,l,a,r,u,d,c,m,v,h,x,f,p,N,g,E,b,y,j,w,T,S,C,I,D,k,A,M,R,L,q,G,P,V,B,H;let{request:Y,requestType:F,onApprove:O,onReject:_,isProcessing:W=!1}=e;return{request:"enrollment"===F?{id:Y.id,studentId:Y.studentId,studentName:Y.student.name,studentPhoneNumber:Y.student.phoneNumber,status:Y.status,enrolledAt:Y.enrolledAt,reason:void 0,sessionDate:null==(s=Y.session)?void 0:s.date,sessionStartTime:null==(n=Y.session)?void 0:n.startTime,sessionEndTime:null==(l=Y.session)?void 0:l.endTime,className:null==(r=Y.session)||null==(a=r.class)?void 0:a.className,classLevel:null==(d=Y.session)||null==(u=d.class)?void 0:u.level,teacherName:(null==(v=Y.session)||null==(m=v.class)||null==(c=m.teacher)?void 0:c.name)||"미지정",displayEnrolledAt:t(Y.enrolledAt),displaySessionDate:(null==(h=Y.session)?void 0:h.date)?t(Y.session.date):void 0,displaySessionTime:(null==(x=Y.session)?void 0:x.startTime)&&(null==(f=Y.session)?void 0:f.endTime)?"".concat(i(Y.session.startTime)," - ").concat(i(Y.session.endTime)):void 0,statusColor:o(Y.status),canApprove:"PENDING"===Y.status,canReject:"PENDING"===Y.status}:{id:Y.id,studentId:Y.studentId,studentName:(null==(p=Y.student)?void 0:p.name)||"알 수 없음",studentPhoneNumber:null==(N=Y.student)?void 0:N.phoneNumber,reason:Y.reason,detailedReason:void 0,refundAmount:Y.refundAmount,status:Y.status,requestedAt:Y.requestedAt,bankName:Y.bankName,accountNumber:Y.accountNumber,accountHolder:Y.accountHolder,sessionDate:null==(E=Y.sessionEnrollment)||null==(g=E.session)?void 0:g.date,sessionStartTime:null==(y=Y.sessionEnrollment)||null==(b=y.session)?void 0:b.startTime,sessionEndTime:null==(w=Y.sessionEnrollment)||null==(j=w.session)?void 0:j.endTime,className:(null==(C=Y.sessionEnrollment)||null==(S=C.session)||null==(T=S.class)?void 0:T.className)||"클래스명 없음",classLevel:(null==(k=Y.sessionEnrollment)||null==(D=k.session)||null==(I=D.class)?void 0:I.level)||"미지정",teacherName:(null==(L=Y.sessionEnrollment)||null==(R=L.session)||null==(M=R.class)||null==(A=M.teacher)?void 0:A.name)||"미지정",displayRequestedAt:t(Y.requestedAt),displayRefundAmount:"".concat(Y.refundAmount.toLocaleString(),"원"),displaySessionDate:(null==(G=Y.sessionEnrollment)||null==(q=G.session)?void 0:q.date)?t(Y.sessionEnrollment.session.date):void 0,displaySessionTime:(null==(V=Y.sessionEnrollment)||null==(P=V.session)?void 0:P.startTime)&&(null==(H=Y.sessionEnrollment)||null==(B=H.session)?void 0:B.endTime)?"".concat(i(Y.sessionEnrollment.session.startTime)," - ").concat(i(Y.sessionEnrollment.session.endTime)):void 0,statusColor:o(Y.status),canApprove:"PENDING"===Y.status,canReject:"PENDING"===Y.status},requestType:F,onApprove:O,onReject:_,isProcessing:W}}function c(e){let{requests:s,selectedTab:n,selectedSessionId:l,isLoading:t,error:i,isProcessing:o,showRejectionModal:a,selectedRequest:r}=e;return{requests:s,selectedTab:n,selectedSessionId:l,isLoading:t,error:i,isProcessing:o,showRejectionModal:a,selectedRequest:r,hasRequests:s.length>0,requestCount:s.length,emptyMessage:"enrollment"===n?"수강 신청이 없습니다.":"환불 요청이 없습니다."}}function m(e){var s;let{profile:n,isEditing:l,editedInfo:t,isLoading:i,error:o,isPrincipal:a,isPhoneVerificationRequired:r,isPhoneVerified:u,verificationCode:d,timeLeft:c,isTimerRunning:m,validationErrors:v,isShaking:h}=e;return{profile:n,isEditing:l,editedInfo:t,isLoading:i,error:o,isPrincipal:a,isPhoneVerificationRequired:r,isPhoneVerified:u,verificationCode:d,timeLeft:c,isTimerRunning:m,validationErrors:v,isShaking:h,isInitialLoading:!n&&a&&!o,canSave:!i&&(!r||u),phoneDisplayValue:(null==n?void 0:n.phoneNumber)||"전화번호가 없습니다.",academyDisplayValue:(null==n||null==(s=n.academy)?void 0:s.name)||"소속 학원이 없습니다."}}function v(e){let{enrollments:s,refundRequests:n,selectedTab:l,isLoading:t,error:i}=e,o=new Map;"enrollment"===l?(s||[]).filter(e=>"PENDING"===e.status).forEach(e=>{var s,n,l,t,i,a,r,u,d;let c=null==(n=e.session)||null==(s=n.class)?void 0:s.id,m=null==(t=e.session)||null==(l=t.class)?void 0:l.className,v=null==(r=e.session)||null==(a=r.class)||null==(i=a.teacher)?void 0:i.name,h=(null==(d=e.session)||null==(u=d.class)?void 0:u.level)||"BEGINNER";if(!c)return;o.has(c)||o.set(c,{id:c,name:m||"클래스 ".concat(c),pendingCount:0,sessions:[],teacherName:v||"미지정",level:h});let x=o.get(c);x.pendingCount++,x.sessions.push(e)}):(n||[]).forEach(e=>{var s,n,l,t,i,a,r,u,d,c,m,v,h;let x=null==(l=e.sessionEnrollment)||null==(n=l.session)||null==(s=n.class)?void 0:s.id,f=null==(a=e.sessionEnrollment)||null==(i=a.session)||null==(t=i.class)?void 0:t.className,p=null==(c=e.sessionEnrollment)||null==(d=c.session)||null==(u=d.class)||null==(r=u.teacher)?void 0:r.name,N=(null==(h=e.sessionEnrollment)||null==(v=h.session)||null==(m=v.class)?void 0:m.level)||"BEGINNER";if(!x)return;o.has(x)||o.set(x,{id:x,name:f||"클래스 ".concat(x),pendingCount:0,sessions:[],teacherName:p||"미지정",level:N});let g=o.get(x);g.pendingCount++,g.sessions.push(e)});let a=Array.from(o.values()).filter(e=>e.id);return{classes:a,selectedTab:l,isLoading:t,error:i,hasClasses:a.length>0,emptyMessage:"enrollment"===l?"수강 신청이 대기 중인 클래스가 없습니다.":"환불 요청이 대기 중인 클래스가 없습니다."}}function h(e){let{enrollments:s,refundRequests:n,selectedTab:l,selectedClassId:t,isLoading:i,error:o}=e,a=new Map;"enrollment"===l?s.filter(e=>{var s,n;let l=null==(n=e.session)||null==(s=n.class)?void 0:s.id;return"PENDING"===e.status&&l===t}).forEach(e=>{let s=e.sessionId;if(!a.has(s)){var n,l,t,i,o,r,u,d,c,m;a.set(s,{sessionId:s,className:(null==(l=e.session)||null==(n=l.class)?void 0:n.className)||"클래스명 없음",date:(null==(t=e.session)?void 0:t.date)||"",startTime:(null==(i=e.session)?void 0:i.startTime)||"",endTime:(null==(o=e.session)?void 0:o.endTime)||"",level:(null==(u=e.session)||null==(r=u.class)?void 0:r.level)||"BEGINNER",teacherName:(null==(m=e.session)||null==(c=m.class)||null==(d=c.teacher)?void 0:d.name)||"미지정",currentStudents:0,maxStudents:0,pendingCount:0,enrollments:[]})}let v=a.get(s);v.pendingCount++,v.enrollments.push(e)}):(n||[]).filter(e=>{var s,n,l;return(null==(l=e.sessionEnrollment)||null==(n=l.session)||null==(s=n.class)?void 0:s.id)===t}).forEach(e=>{var s,n,l,t,i,o,r,u,d,c,m,v,h,x,f,p,N,g;let E=null==(n=e.sessionEnrollment)||null==(s=n.session)?void 0:s.id;if(!E)return;a.has(E)||a.set(E,{sessionId:E,className:(null==(i=e.sessionEnrollment)||null==(t=i.session)||null==(l=t.class)?void 0:l.className)||"클래스명 없음",date:(null==(r=e.sessionEnrollment)||null==(o=r.session)?void 0:o.date)||"",startTime:(null==(d=e.sessionEnrollment)||null==(u=d.session)?void 0:u.startTime)||"",endTime:(null==(m=e.sessionEnrollment)||null==(c=m.session)?void 0:c.endTime)||"",level:(null==(x=e.sessionEnrollment)||null==(h=x.session)||null==(v=h.class)?void 0:v.level)||"BEGINNER",teacherName:(null==(g=e.sessionEnrollment)||null==(N=g.session)||null==(p=N.class)||null==(f=p.teacher)?void 0:f.name)||"미지정",currentStudents:0,maxStudents:0,pendingCount:0,refundRequests:[]});let b=a.get(E);b.pendingCount++,b.refundRequests.push(e)});let r=Array.from(a.values());return{sessions:r,selectedTab:l,selectedClassId:t,isLoading:i,error:o,hasSessions:r.length>0,emptyMessage:"enrollment"===l?"수강 신청이 대기 중인 세션이 없습니다.":"환불 요청이 대기 중인 세션이 없습니다.",showClassSelectionMessage:!t}}function x(e){let{student:s,history:n,isLoading:l,error:t}=e;return{student:s,history:n,isLoading:l,error:t,hasHistory:n.length>0,emptyMessage:"수강 기록이 없습니다."}}},5078:(e,s,n)=>{n.r(s),n.d(s,{default:()=>h});var l=n(5155),t=n(4582),i=n(2115),o=n(8651),a=n(4522),r=n(714),u=n(6852),d=n(1785),c=n(6344),m=n(2853);let v=e=>{let{title:s,description:n,isNew:t,onClick:i}=e;return(0,l.jsxs)("div",{className:"flex gap-10 justify-between items-center py-4 pr-4 pl-5 w-full text-base tracking-normal rounded-lg bg-stone-200 text-stone-700 cursor-pointer hover:bg-stone-400 transition-colors duration-200",onClick:i,role:"button",tabIndex:0,children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1.5 items-start self-stretch my-auto",children:[(0,l.jsxs)("div",{className:"flex gap-1.5 items-center",children:[t&&(0,l.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-white bg-red-500 rounded-full",children:"NEW"}),(0,l.jsx)("div",{className:"text-base font-medium tracking-normal text-stone-700",children:s})]}),(0,l.jsx)("div",{className:"text-sm text-stone-600",children:n})]}),(0,l.jsx)("div",{className:"shrink-0 self-stretch my-auto w-4 aspect-square flex items-center justify-center",children:(0,l.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-600",children:(0,l.jsx)("path",{d:"M9 18L15 12L9 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})};function h(){var e,s;let n=(0,t.Rt)(),{data:h,status:x}=(0,t.wV)(),{navigation:f}=(0,c.nm)(),{navigateToSubPage:p}=f,{calendarSessions:N,loadSessions:g,isLoading:E,error:b}=(0,o.k)(),[y,j]=(0,i.useState)(null),[w,T]=(0,i.useState)(!1),[S,C]=(0,i.useState)(null),[I,D]=(0,i.useState)(!1);(0,i.useEffect)(()=>{g()},[g]);let k=(0,i.useMemo)(()=>{let e=new Date;return{startDate:new Date(e.getFullYear(),e.getMonth(),1),endDate:new Date(e.getFullYear(),e.getMonth()+2,0)}},[]);if("loading"===x||E)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-full",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-stone-700"})});if(b){let e=b&&"object"==typeof b&&"response"in b?b:null;return(null==e||null==(s=e.response)?void 0:s.status)===401?(n({redirect:!0,callbackUrl:"/auth"}),null):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-full",children:[(0,l.jsx)("p",{className:"text-red-500",children:"데이터를 불러오는데 실패했습니다."}),(0,l.jsx)("button",{onClick:()=>g(),className:"mt-4 px-4 py-2 bg-stone-700 text-white rounded-lg hover:bg-stone-800",children:"다시 시도"})]})}return(0,l.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,l.jsxs)("header",{className:"flex-shrink-0",children:[(0,l.jsx)("div",{className:"flex flex-col px-5 py-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-2xl font-bold text-stone-700",children:["안녕하세요, ",null==h||null==(e=h.user)?void 0:e.name," 원장님!"]}),(0,l.jsx)("p",{className:"mt-2 text-stone-500",children:"학원의 모든 강의를 한눈에 확인하세요!"})]}),(0,l.jsx)("button",{onClick:()=>{p("principal-all-classes")},className:"flex items-center justify-center w-12 h-12 bg-stone-100 rounded-full hover:bg-stone-200 transition-colors","aria-label":"전체 클래스 보기",children:(0,l.jsx)("svg",{className:"w-6 h-6 text-stone-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})}),(0,l.jsx)("div",{className:"flex flex-col w-full bg-white text-stone-700",style:{height:"calc(100vh - 450px)"},children:(0,l.jsx)(u.S,{mode:"teacher-view",sessions:N.map(m.Td),selectedSessionIds:new Set,onSessionSelect:()=>{},onDateClick:e=>{j(new Date(e)),T(!0)},calendarRange:k,children:(0,l.jsx)(d.q,{})})}),(0,l.jsx)("div",{className:"flex flex-col px-5 py-4 border-t border-gray-200",children:(0,l.jsx)("div",{className:"flex flex-col self-center w-full font-semibold leading-snug text-center max-w-[335px]",children:(0,l.jsx)(v,{title:"강의 개설",description:"새로운 강의를 개설하고 선생님을 배정하세요",onClick:()=>{p("create-class")}})})})]}),(0,l.jsx)(a.A,{isOpen:w,selectedDate:y,onClose:()=>{T(!1),j(null)},onSessionClick:e=>{C(N.find(s=>s.id===e.id)),D(!0)},role:"principal"}),(0,l.jsx)(r.V,{isOpen:I,sessionId:(null==S?void 0:S.id)||null,onClose:()=>{D(!1),C(null)},role:"principal"})]})}}}]);